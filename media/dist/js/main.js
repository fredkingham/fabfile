!function(e){"use strict";function t(){this.offsets=[],this.targets=[],this.refresh()}t.prototype={constructor:t,refresh:function(){var e=this;this.targets=[],this.offsets=[],$(".date").each(function(t,n){e.offsets.push($(n).position().top);var r=$(n).attr("id");e.targets.push(createDate(r.substring(1)))}),this.setup()},process:function(){var t=$(window).scrollTop()+400,n=this.offsets,r=this.targets;for(var i=this.offsets.length;i--;)t>=n[i]&&(!n[i+1]||t<=n[i+1])&&r[i]!==e.objects.dateLineManager().active()&&this.activate(r[i])},activate:function(t){e.objects.dateLineManager().activateDateSection(t)},setup:function(){$(window).on("scroll.date-line-spy",function(){e.objects.dateLineSpy.process()})},tearDown:function(){$(window).off("scroll.date-line-spy")}},e.objects.dateLineSpy=new t}(modelPageView),!function(e){"use strict";var t=function(e){this.init(e)};t.prototype={constructor:t,init:function(e){this.calType=e.cal_type,this.cal=e.user?e.user:undefined,this.tag=e.tag?e.tag:undefined,this.type=this.getType(),this.img=e.img},className:"CalTag",equals:function(e){return e.calType===this.calType&&e.cal===this.cal&&e.tag===this.tag},sameCal:function(e){return e.cal===this.cal},isChild:function(e,t){if(this.type<e.type){if(this.calType===e.calType)return t?this.type===0&&(e.type===1||e.type===2):!0;if(this.type===1&&e.type===3)return e.cal===this.cal}return!1},getType:function(){return this.tag&&this.cal?3:this.tag?2:this.cal?1:0},onlyTag:function(){return this.type===2},isRelated:function(e){return this.equals(e)||e.isChild(this)||this.isChild(e)},toJSON:function(){return{cal:this.cal,tag:this.tag,calType:this.calType}}},e.CalTag=t}(modelPageView),!function(e){"use strict";var t=function(t){var n=this;this.init(t),this.msg=ko.computed(function(){return e.objects.docInfo.today().sameDate(n.date)?e.objects.docInfo.today().isTomorrow(n.date)?n.date.displayName():n.date.displayName()+", Tomorrow":n.date.displayName()+", Today"})};t.prototype={constructor:t,init:function(e){this.date=e,this.timeLineId="s"+String(this.date.asInt())},date_string:function(){return this.date.displayName()},templateName:"datetmp"},e.dateTitleFactory=function(e){return t(e)}}(modelPageView),!function(e){"use strict";function i(t){this.date=t,this.url=e.utils.constructURL(this.date),this.occurances=ko.observable("")}function s(e,t){this.init(e,t)}var t=0,n=1,r=2;i.prototype={constructor:i},s.prototype={constructor:s,init:function(i,s){var o=e.objects.docInfo.today(),u=$(window).width(),a=e.objects.docInfo.size;this.rangeType=a==="small"?r:a==="medium"?n:t,this.forDate=ko.utils.unwrapObservable(i),this.dates=this.calcDates(this.forDate,this.rangeType,s),this.occurancesLoad(this.forDate);var f=this.dates;this.active=ko.observable(this.forDate)},goBack:function(t){var n=this.dates[0].date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1);e.objects.docInfo.forDate(r),e.objects.dateLineManager(new s(r,!0)),t&&(e.objects.streamHolder().refresh(),$(window).scrollTop(150),console.log("going back"))},goForward:function(t){var n=this.dates[this.dates.length-1].date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1);e.objects.docInfo.forDate(r),e.objects.dateLineManager(new s(r,!1)),t&&e.objects.streamHolder().refresh()},calcDates:function(e,s,o){var u,a;if(s===t)u=new Date(e),u.setDate(1),a=new Date(u),a.setMonth(e.getMonth()+1);else if(s===r&&!o)u=e.getPreviousDay(1),a=new Date(u),a.setDate(a.getDate()+7);else if(s===r&&o)a=new Date(e),a.setDate(a.getDate()+1),u=new Date(a),u.setDate(u.getDate()-7);else if(s===n&&o)a=new Date(e),a.setDate(a.getDate()+1),u=new Date(a),u.setDate(u.getDate()-14);else{if(s!==n||!!o)throw"unknown range type";u=e.getPreviousDay(1),a=new Date(u),a.setDate(a.getDate()+14)}var f=[],l=u;while(l<a){f.push(new i(l));var c=new Date(l);c.setDate(l.getDate()+1),l=c}return f},registerJquery:function(e,t){$(e).tooltip({placement:"bottom"})},occurancesLoad:function(e){var t=this,n=new Date(e.getFullYear(),e.getMonth(),1),r=new Date(e.getFullYear(),e.getMonth()+1,1),i={startDate:n.asInt(),endDate:r.asInt()};$.get("/!get_dateLine/",i,function(e){if(e===1)alert("um something wrong has happened, please refresh your page");else for(var n in e){var r=ko.utils.arrayFirst(t.dates,function(e){return e.date.sameDate(createDate(n))===0}),i=e[n];i>3&&(i=3);var s="";for(var o=0;o<i;o++)s+="*";r&&i&&r.occurances(s)}})},otherMonth:function(e,t){return new Date(e.getFullYear(),e.getMonth()+t,1)},getLink:function(t){var n=e.objects.utils.constructURL(t);return console.log("url is "+n),n},activateDateSection:function(e){var t=ko.utils.arrayFirst(this.dates,function(t){return t.date.equalDate(e)});t?this.active(e):e&&this.active()&&(e.getMonth()>this.active().getMonth()?this.goForward():e.getMonth()<this.active().getMonth()&&this.goBack())}},e.DateLineManager=s}(modelPageView),!function(e){"use strict";function t(){var e=this;this.img=ko.observable(),this.populate=function(t){e.getImg(t)}}function n(){this.followers=ko.observableArray();var e=this;$.get("/!get_invitees",function(t){e.followers(t)})}t.prototype={constructor:t,getImg:function(e){var t=new Date,n=this;$.get("/d/get_img",{username:e},function(e){n.img(e)})}},e.objects.userDetails=new t,n.prototype={constructor:n},e.objects.followerHolder=new n}(modelPageView),!function(e){"use strict";var t=function(e,t){var n=this;this.modal_init(e,t),this.template=ko.observable("blank"),this.name="modelModal",this.ready=ko.observable(!1)};t.prototype={constructor:t,modal_init:function(){this.appear=ko.observable(!1)},open:function(){this.appear(!0),$("#modal").modal("show")},close:function(){this.appear(!1),$("#modal").modal("hide")}},e.objects.modalModel=new t;var n=function(e,t){var n=this;n.name=e.name,n.id=e.id,n.img=e.img,n.selected=ko.observable(t),n.select=function(){n.selected(!n.selected())}},r=function(e,t){this.init(),this.followers=ko.observableArray([]),this.populated=!1};r.prototype={constructor:r,init:function(){this.attendees=ko.observableArray([]),this.result=null,this.callback=null,this.template="inviteModal",this.closer=ko.observable(!1)},refreshSelected:function(){var t=this,r=e.objects.followerHolder.followers();t.followers([]),_.each(r,function(e){return t.followers.push(new n(e,_.any(t.attendees(),function(t){return t===e.name})))})},populate:function(t,n,r){this.attendees(t()),this.result=t,this.refreshSelected(),this.closer=n,this.callback=r,e.objects.modalModel.template("inviteModal"),e.objects.modalModel.open()},invite:function(){var e=this,t=_.filter(e.followers(),function(e){return e.selected()}),n=_.map(t,function(e){return e.name});this.result(n),this.callback&&this.callback(),this.cancel()},cancel:function(){this.attendees([]),this.result=null,e.objects.modalModel.close()}};var i=function(){};i.prototype={constructor:i,populate:function(){this.twitter=ko.observable(),this.submitted=ko.observable(!1),this.errorText=ko.observable(),this.loading=ko.observable(),e.objects.modalModel.template("signupModal"),e.objects.modalModel.open()},cancel:function(){this.twitter(""),this.errorText(""),this.submitted(!1),this.loading(!1),e.objects.modalModel.close()},signUp:function(){var e=this;this.loading(!0);if(!this.twitter()||!this.twitter().length)return this.errorText("that doesn't look right, can you double check?"),!1;$.post("/!sign_up",{twitter:this.twitter()},function(t){t.issue===0?(console.log("data is "+JSON.stringify(t)),e.submitted(!0),e.loading(!1)):e.errorText("something wrong happend, please try again later")})}},e.objects.loginSignUpModal=new i,e.decorators.loginRequired=function(t){e.objects.docInfo.user.length?t():e.objects.loginSignUpModal.populate()};var s=function(){this.init()};s.prototype={constructor:s,init:function(){this.venueId=ko.observable(),this.venueName=ko.observable(),this.possibleVenues=ko.observableArray([]),this.venueCreatorModal=ko.observable(!1)},close:function(){e.objects.modalModel.close(),$(".where").val(""),this.refresh()},add:function(){this.callBack(this.venueId(),this.venueName()),e.objects.modalModel.close()},cancel:function(){this.venueId(!1),this.venueName(!1),e.objects.modalModel.close()},getVenues:function(t,n){$.ajax({type:"GET",url:"/!get_venues/",dataType:"json",data:{startString:t,delay:.5},success:function(t){var r={label:"add new venue",id:0,func:function(){e.objects.venueCreatorModal.populate()}};t.push(r),n(t)}})},selectVenue:function(e){this.venue(e)},template:"venuePickerModal",populate:function(t){e.objects.modalModel.template(this.template),e.objects.modalModel.open(),this.callBack=t}},e.objects.venuePickerModal=new s;var o=function(){this.init()};o.prototype={constructor:o,init:function(){this.name=ko.observable(),this.address=ko.observable(),this.postcode=ko.observable(),this.private=ko.observable(),this.errorText=ko.observable(),this.successText=ko.observable(),this.template="venueCreatorModal"},populate:function(){e.objects.modalModel.template("venueCreatorModal"),e.objects.modalModel.open()},createVenue:function(){var t=this;if(!t.validate(this.name))this.errorText("Please enter a name");else if(!t.validate(this.address))this.errorText("Please enter an address");else if(!t.validate(this.postcode))this.errorText("Please enter a postcode");else{var n={};n.name=this.name(),n.address=this.address(),n.postcode=this.postcode(),n.private=this.private(),$.post("/submit_venue",n,function(n){n>0?t.errorText("ah didn't work, please refresh the page and try again"):(t.successText("thanks venue added"),_.delay(function(){e.objects.modalModel.close()},500),t.successText(""))})}},refresh:function(){this.name(""),this.address(""),this.postcode(""),this.errorText("")},close:function(){e.objects.modalModel.close(),$(".where").val(""),this.refresh()},validate:function(e){return e()&&$.trim(e()).length}};var u=function(){};u.prototype={constructor:u,populate:function(t){this.id=t.id,self.successText=ko.observable(),self.errorText=ko.observable(),e.objects.modalModel.template("eventCancellerModal"),e.objects.modalModel.open()},cancel:function(t){e.objects.modalModel.close()},post:function(t){$.post("/!cancel_event/",{id:this.id},function(t){t===0?(self.successText("ok, event cancelled"),_.delay(function(){e.objects.modalModel.close(),e.objects.streamHolder().refresh(),self.successText("")},300)):self.errorText("ah didn't work, please refresh the page and try again")})}},"objects"in e?e.objects.inviteBox=new r:e.objects={inviteBox:new r},e.objects.venueCreatorModal=new o,e.objects.cancellerModal=new u}(modelPageView),!function(e){var t=function(e){this.init(e)};t.prototype={constructor:t,init:function(e){this.show=ko.observable(!1),this.title=e.title,this.address=e.address,this.lat=e.lat,this.lng=e.lng,this.link="http://maps.google.com/?ie=UTF8&q="+e.lat+","+e.lng+"&z=19"},reveal:function(e){e.show(!0);var t=new google.maps.LatLng(e.lat,e.lng),n={zoom:15,center:t,mapTypeId:google.maps.MapTypeId.ROADMAP},r=new google.maps.Map(document.getElementById("map_canvas"),n),i=new google.maps.Marker({position:t,map:r,title:e.title})},close:function(){this.show(!1)}};var n=function(e){this.username=e.username,this.user_id=e.user_id,this.img=e.img_url,this.selected=ko.observable(e.selected)},r=function(e){this.init(e)};r.prototype={constructor:r,init:function(e){this.show=ko.observable(!1),this.eventId=e,this.reveal=$.proxy(this.display,this)},load:function(){var e=this;this.loading=ko.observable(!0),e.show(!0),$.get("/!get_attending/",{id:e.eventId},function(t){e.attendees(ko.utils.arrayMap(t.attendees,function(e){return new n(e)})),e.privatelyAttending(t.privately_added),e.loading(!1)})},display:function(){this.attendees=ko.observableArray([]),this.privatelyAttending=ko.observable(0),this.load()},closeBox:function(){this.attendees([]),this.privatelyAttending(0),this.show(!1)}},e.attendeeHolderFactory=function(e){return new r(e)};var i=function(e){this.initDiscuss(e)};i.prototype={constructor:i,initDiscuss:function(e){e&&(this.id=e.id),this.show=ko.observable(!1)},display:function(t,n){$.get("/!get_notes/",{id:n},function(n){n===1?alert("something wrong happened, please try again later"):(t.notes(ko.utils.arrayMap(n,function(t){return new e.Note(t)})),t.notesLoaded(!0))}),$script.ready(["jQueryUI","underscore"],function(){t.description=ko.observable();var e=_.throttle(function(){t.analyseUsers(t)},5e3);t.notes=ko.observableArray(),t.notesLoaded=ko.observable(!1),t.subscription=t.description.subscribe(e),t.showInvites=ko.observable(!1),t.desc_invitees=ko.observableArray(),t.selectedInvitees=ko.observableArray(),t.invitees=ko.computed(function(){return _.compact(_.uniq(_.union(t.desc_invitees(),t.selectedInvitees())))}),t.show(!0)})},reset:function(){this.description("")},openInvites:function(){e.objects.inviteBox.populate(this.selectedInvitees,this.showInvites),this.showInvites(!0)},closeBox:function(){this.subscription.dispose(),this.description(""),this.desc_invitees=ko.observableArray([]),this.selectedInvitees=ko.observableArray([]),this.show(!1)},getAnalysisData:function(){return this.description()},analyseUsers:function(e){var t=/(?:\W|^)@(\w*)/g,n=e.getAnalysisData();if(!n||!n.length)return;var r=_.map(n.match(t),function(e){return $.trim(e).substr(1)}),i=_.difference(r,e.desc_invitees()),s=_.difference(e.desc_invitees(),r);i.length?$.get("/!are_users",{uns:i},function(t){t.length?e.desc_invitees(_.uniq(_.difference(e.desc_invitees().concat(t),s))):e.desc_invitees(_.difference(e.desc_invitees(),s))}):e.desc_invitees(_.difference(e.desc_invitees(),s))},post:function(t){var t=this;$.post("/!discuss_creator/",{description:this.description(),eventId:this.id,who:this.invitees()},function(){t.show(!1),e.objects.streamHolder().refresh()})}};var s=function(e){this.initDiscuss(e),this.initEventCreator()};s.prototype=jQuery.extend(!0,{},i.prototype),$.extend(s.prototype,{constructor:s,initEventCreator:function(){var t=this;this.updatedDate=!1,this.updatedTime=!1,this.private=ko.observable(!1),this.currentDate=e.objects.docInfo.today(),this.returnedDate,this.eventDate=ko.observable(),this.returnedTime,this.eventTime=ko.observable(),this.revealed=ko.observable(!1),this.revealedDescription=ko.observable(!1),this.overRiddenDate=ko.observable(!1),this.venueId=ko.observable(),this.venueName=ko.observable(),this.repeatEvent=ko.observable(),this.repeatUntil=ko.observable(),this.errorText=ko.observable(),this.successText=ko.observable(),this.eventFocused=ko.observable(!1),this.subscriptions=[],t.showForLarge=ko.computed(function(){return t.show()&&e.objects.docInfo.size==="large"}),t.showForSmall=ko.computed(function(){return t.show()&&e.objects.docInfo.size!=="large"}),t.imgUrl=ko.observable(),t.imgId=ko.observable(),t.loadingPreview=ko.observable(!1),t.img=ko.observable(),t.imgName=ko.observable(),t.fileName=ko.computed(function(){return t.img()&&!t.imgId?t.img().replace(/^.*[\\\/]/,""):""})},uploadPreview:function(e){var t=this;t.loadingPreview(!0),file=e[0],file.size>2e7&&alert("that image is a bit too big for us, got anything smaller?");var n=new FormData;n.append("img",file),$.ajax({url:"/!img_preview",type:"POST",data:n,cache:!1,contentType:!1,processData:!1}).done(function(e){if(e==="error"){alert("somethign wrong happened, please refresh the page");return}t.imgUrl(e.img_url),t.imgId(e.img_id)}).fail(function(){t.loadingPreview(!1)})},cancelPreview:function(e){e.img(null),e.imgId(null),e.imgUrl(null),e.loadingPreview(null)},togglePrivate:function(){this.private(!this.private())},reveal:function(){e.objects.docInfo.size!=="large"?window.location.href="/#c/":this.display()},display:function(){var e=this;$script.ready(["jQueryUI","underscore"],function(){e.showInvites=ko.observable(!1),e.desc_invitees=ko.observableArray(),e.selectedInvitees=ko.observableArray(),e.eventFocused(!0),e.description=ko.observable(""),e.title=ko.observable("");var t=_.throttle(function(){e.analyse(e)},500);e.subscriptions.push(e.title.subscribe(t)),e.errorTitle=ko.observable(!1),e.errorDescription=ko.observable(!1),e.errorDate=ko.observable(!1),e.subscriptions.push(e.description.subscribe(t)),e.invitees=ko.computed(function(){return _.compact(_.uniq(_.union(e.desc_invitees(),e.selectedInvitees())))}),e.show(!0)})},getVenue:function(){var t=this,n=function(e,n){t.venueId(e),t.venueName(n)};this.venuePickerModal=e.objects.venuePickerModal,this.venuePickerModal.populate(n)},getAnalysisData:function(){return this.title()+" "+this.description()},analyse:function(e){e.analyseUsers(e),e.analyseDateTime(e)},analyseDateTime:function(e){var t=e.eventDate()&&e.eventDate()!==e.returnedDate,n=e.eventTime()&&e.eventTime()!==e.returnedTime;(!e.updatedDate||!e.updatedTime)&&$.post("/!event_info_process",{data:e.getAnalysisData()},function(r){"date"in r&&!t&&(e.returnedDate=createDate(r.date),e.eventDate(e.returnedDate)),"time"in r&&!n&&(e.returnedTime=r.time,e.eventTime(e.returnedTime))})},errorChecks:function(){var e=!1,t=this.title().length,n=this.description().length,r=this,i=function(){r.errorTitle(!1),r.errorText("")},s=function(){r.errorDescription(!1),r.errorText("")};if(!t)this.errorText("please enter a name for your event"),this.errorTitle(!0),e=!0,this.subscriptions.push(r.title.subscribe(i));else if(t>100)this.errorTitle(!0),this.errorText("please can you leave a shorter title"),e=!0,this.subscriptions.push(r.title.subscribe(i));else if(n>250)this.errorDescription(!0),this.errorDescription("please can you leave a shorter description"),this.subscriptions.push(r.title.subscribe(s)),e=!0;else if(!this.eventDate()||this.eventDate().getFullYear()===1970)this.errorText("please enter a date for your event"),this.errorDate(!0),e=!0;return e},post:function(t){var t=this;console.log("done and done"),console.log("all invitees "+JSON.stringify(t.invitees()));if(!t.errorChecks()){if(t.img()&&!t.imgUrl)return console.log("we go down here"),!0;console.log("we don't know why "+!t.private()),$.post("/!event_creator_from_json/",{title:t.title(),description:t.description(),invited:t.invitees().join(),event_date:t.eventDate(),event_time:t.eventTime(),event_venue:t.venueId(),"public":!t.private(),repeatEvent:t.repeatEvent(),repeatUntil:t.repeatUntil(),img_id:t.imgId()},function(n){n===0?(console.log("we should be here"),t.errorText(""),t.successText("thanks, added"),t.removeSubscriptions(),_.delay(function(){t.closeBox(),e.objects.streamHolder().refresh(),t.initEventCreator()},300)):t.errorText(n)})}return!1},toggleDescription:function(){this.revealedDescription(!this.revealedDescription())},removeSubscriptions:function(){ko.utils.arrayMap(this.subscriptions,function(e){e.dispose()})},closeBox:function(){this.removeSubscriptions(),this.title(""),this.description(""),this.show(!1),this.errorText(!1),this.errorDescription(!1),this.errorDate(!1),this.showForSmall()&&(window.location.href="/")}});var o=function(){this.initBox()};o.prototype={constructor:o,initBox:function(){this.show=ko.observable(!1),this.loaded=ko.observable(!1),this.closeable=!0},close:function(){this.show(!1)}};var u=function(e){this.initBox(),this.initDiscuss(e),this.initEventCreator(e)};u.prototype=jQuery.extend(!0,{},s.prototype),$.extend(u.prototype,jQuery.extend(!0,{},o.prototype)),$.extend(u.prototype,{constructor:u,populate:function(e){var t=/<.*?>/g,n=this;this.id=e.id,this.updatedDate=!0,this.updatedTime=e.time?!0:!1,this.eventTime(e.time),this.id=e.id,this.eventDate=ko.observable(e.date),this.title=ko.observable(e.title.replace(t,"")),this.venueName=e.venue?e.venue.title:!1,n.errorTitle=ko.observable(!1),n.errorDescription=ko.observable(!1),n.errorDate=ko.observable(!1),e.description?this.description=ko.observable(e.description.replace(t,"")):this.description=ko.observable("");var r=e.description||e.venue?!0:!1;this.revealedDescription(r),this.img=e.img,this.private=ko.observable(e.private),this.event=e,this.desc_invitees=ko.observableArray(),this.selectedInvitees=ko.observableArray(),this.invitees=ko.computed(function(){return _.compact(_.uniq(_.union(n.desc_invitees(),n.selectedInvitees())))})},post:function(t){var t=this;t.errorChecks()||$.post("/!event_editor/",{title:t.title(),description:t.description(),invited:t.invitees(),event_date:t.eventDate(),event_time:t.eventTime(),venue:t.venueName,"public":!0,repeatEvent:t.repeatEvent(),repeatUntil:t.repeatUntil(),event_id:t.id},function(n){n===0?(t.errorText(""),t.successText("thanks, changed"),t.removeSubscriptions(),t.revealed(!1),_.delay(function(){e.objects.streamHolder().refresh()},300)):t.errorText(n)})}}),e.canceller=function(){return new Canceller},e.noteCreator=function(e){return new i(e)},e.boxCreator=function(){return new o},e.eventEditor=function(){return new u},e.objects.eventCreator=new s,e.discussCreator=function(e){return new i(e)},e.venueDisplayFactory=function(e){return new t(e)}}(modelPageView),!function(e){"use strict";var t=function(e){this.init(e)};t.prototype={constructor:t,init:function(e){var t=this;this.shareButton=ko.observable(!1),this.sharedx=ko.observable(e.shared),this.highlighted=!1;for(var n in e)this[n]=e[n];"details"in e&&("detailButton"in e&&alert("something wrong has happened"),t.detailButton=ko.observable(!1),t.acceptedx=ko.observable(e.accepted),t.setDetailButton=function(e){t.detailButton(e)},t.accept=function(){$.post("/share_detail/",{id:t.detail_id},function(e){if(e===1){var n=t.acceptedx()?!1:!0;t.acceptedx(n)}})})},setShareButton:function(e){this.shareButton(e)},share:function(){var e=this;$.post("/share_note/",{id:e.note_id},function(t){if(t===1){var n=e.sharedx()?!1:!0;e.sharedx(n)}})}},e.Note=t;var n=function(e){this.init(e)};n.prototype={constructor:n,init:function(e){var t=this;t.optionType=e,t.optionName=e;if(e==="add"||e==="accept"||e==="add privately"||e==="accept privately"){t.action=t.add;if(e==="add"||e==="accept")t.img="main/img/startryouts/grey7.gif";if(e==="add privately"||e==="accept privately")t.img="main/img/icons/private1.png"}else if(e==="remove"||e==="unable")t.action=t.remove,t.img="main/img/startryouts/red7.gif";else if(e==="discuss")t.action=t.discuss;else if(e==="invite")t.action=t.invite,t.img="main/img/icons/invite.png";else if(e==="notes")t.action=t.getNotes;else if(e==="edit")t.action=t.edit;else if(e==="cancel")t.action=t.cancel,t.img="main/img/startryouts/red7.gif";else{if(e!=="show responses")throw"unknown option "+e;t.action=function(){alert("we're still working on this")}}},discuss:function(e,t){t.discuss.reveal(t.discuss)},invite:function(e,t){$("#modelView").modal("show"),t.openInvites()},remove:function(e,t){var n=this,r={action:n.optionType,event:t.id};$.post("/!event_option/",r,function(e){e===1?alert("something wrong happened, please try again later"):t.optionHolder.stop_attending()})},add:function(e,t){var n=this,r={action:n.optionType,event:t.id};$.post("/!event_option/",r,function(e){e===1?alert("something wrong happened, please try again later"):(t.optionHolder.attend(),n.isPrivate(n)&&t.private(!0))})},edit:function(e,t){t.eventEditor.populate(t),t.eventEditor.show(!0)},cancel:function(t,n){e.objects.cancellerModal.populate(n)},isPrivate:function(e){return e.optionName==="add privately"||e.optionName==="accept privately"}};var r=function(e,t){this.init(e,t)};r.prototype={constructor:r,statusConstants:{ADDED:0,INVITED:1,ACCEPTED:2,SEND_INVITES:3,UNABLE:4,CANCELLED:5,CREATOR:6},cancel:new n("cancel"),accept:new n("accept"),acceptPrivately:new n("accept privately"),add:new n("add"),addPrivately:new n("add privately"),unable:new n("unable"),remove:new n("remove"),showResponses:new n("show responses"),invite:new n("invite"),init:function(e,t){var n=this;this.options=ko.observableArray([]);var r=[],i=this.statusConstants;n.statuses=ko.observableArray(e),n.creator=$.inArray(i.CREATOR,e)!==-1,n.options=ko.computed(function(){var e=$.inArray(i.ADDED,n.statuses()),r=[];return t?[n.remove]:($.inArray(i.INVITED,n.statuses())!==-1?r=r.concat([n.accept,n.acceptPrivately,n.unable]):$.inArray(i.ACCEPTED,n.statuses())!==-1?r.push(n.unable):$.inArray(i.ADDED,n.statuses())!==-1&&$.inArray(i.CREATOR,n.statuses())===-1?r.push(n.remove):$.inArray(i.CREATOR,n.statuses())!==-1?r.push(n.cancel):r.push(n.add,n.cancel),r.push(n.invite),r)}),n.attending=ko.computed(function(){return ko.utils.arrayFirst(n.statuses(),function(e){return $.inArray(e,[i.ADDED,i.ACCEPTED,i.ADD_PRIVATELY,i.ACCEPT_PRIVATELY])!==-1})!==null})},attend:function(){var e=this.statuses();e.push(this.statusConstants.ADDED),this.statuses(e)},stop_attending:function(){var e=this.statuses(),t=this,n=this.statusConstants.ADDED,r=this.statusConstants.ACCEPTED;this.statuses(ko.utils.arrayFilter(e,function(e){return e!==n&&e!==r}))},toggle:function(){this.attending()?this.stop_attending():this.attend()}};var i=function(e){this.init(e)};i.prototype={constructor:i,eventType:"populated",init:function(t){var n=this;n.eventEditor=e.eventEditor(),n.discuss=e.discussCreator(t),n.optionHolder,n.revealNotes=ko.observable(!1),n.forInvites=ko.observableArray([]),n.showInvites=ko.observable(!1),n.getNoteBox=function(){return e.noteCreator(n)},n.noteDisplay=function(){var t=e.boxCreator();return t.notes=ko.observable([]),t}(),n.invite=function(){var t={names:n.forInvites(),event:n.id};$.post("/!invite",t,function(){e.objects.eventHolder.refresh()})};for(var i in t)i==="attending_status"?n.optionHolder=new r(t[i],t.cancelled):i==="description"||i==="title"?this[i]=t[i]?e.utils.enrichText(t[i]):t[i]:i==="venue"&&t[i]?n.venue=e.venueDisplayFactory(t[i]):this[i]=t[i];"description"in t||(this.description=null),this.private=ko.observable(t.public!==0),this.date=createDate(t.date),this.cal_details=ko.utils.arrayMap(t.from,function(t){return new e.CalTag(t)}),this.from=ko.observableArray(n.calculateFrom()),this.attendeeHolder=e.attendeeHolderFactory(t.id)},edit:function(){this.eventEditor.populate(this),this.eventEditor.show(!0)},cancel:function(){e.objects.cancellerModal.populate(this)},calculateFrom:function(){var e=[];return ko.utils.arrayForEach(this.cal_details,function(t){t.cal?ko.utils.arrayFilter(e,function(e){return e.cal===t.cal}).length||e.push(t):ko.utils.arrayFilter(e,function(e){return!e.cal&&t.tag===e.tag}).length||e.push(t)}),e},revealDiscuss:function(e){var n=e;$.get("/!get_notes/",{id:n.id},function(e){e===1?alert("something wrong happened, please try again later"):(n.discuss.notes(ko.utils.arrayMap(e,function(e){return new t(e)})),n.discuss.notesLoaded(!0))}),n.discuss.reveal(this.discuss)},removeFrom:function(e){this.cal_details=ko.utils.arrayFilter(this.from(),function(t){return!t.isRelated(e)}),this.from(this.calculateFrom())},addFrom:function(e){this.cal_details.push(e),this.from(this.calculateFrom())},closeNotes:function(e){e.showNotes(!1)},openInvites:function(){this.showInvites(!0),e.objects.inviteBox.populate(this.forInvites,this.showInvites,this.invite)},closeBox:function(e){this.show(!1)}},e.eventFactory=function(e){return new i(e)};var s=function(t){var n=this;this.init(t),this.msg=ko.computed(function(){return e.objects.docInfo.today().sameDate(n.date)?e.objects.docInfo.today().isTomorrow(n.date)?n.date.displayName():n.date.displayName()+", Tomorrow":n.date.displayName()+", Today"})};s.prototype={constructor:s,init:function(e){this.date=e,this.timeLineId="s"+String(this.date.asInt())},date_string:function(){return this.date.displayName()}},e.dateTitleFactory=function(e){return new s(e)}}(modelPageView),$script.ready(["main"],function(){!function(e){"use strict";function t(e){var t=this;this.loading=ko.observable(!0),e&&(this.cal=e.cal,this.tag=e.tag),this.genericInit(),this.init()}t.prototype=jQuery.extend(!0,{},e.GenericHolder.prototype),$.extend(t.prototype,{constructor:t,init:function(){var t=this;this.noEvents=ko.computed(function(){return!t.events().length&&!t.loading()&&!e.objects.eventCreator.show()?"no events have been added at this time for those people, select some more and we'll see how we do":""})},loadBottom:function(){if(!this.loadingMoreBottom){var e=this,t=e.getPopulateArgs(),n=e.events(),r=n[n.length-1];r.eventType!="empty"?t.startKey=r.key:t.startDate=r.date,t.direction="bottom",e.loadingMoreBottom=!0,$.get("/!get_all_events",t,function(t){t===1?alert("please try again later"):(e.addEvents(t.events,e),e.updatingBottom(t.more),e.loadingMoreBottom=!1,e.resetDateLine())})}},loadTop:function(){var t=this,n={};if(!t.loadingMoreTop){t.loadingMoreTop=!0,this.cal&&(n.cal=this.cal),this.tag&&(n.tag=this.tag);var r=ko.utils.arrayFilter(t.events(),function(e){return e.eventType!="empty"});n.direction="top";if(r.length){var i=r[0];i.key?n.endKey=i.key:n.endDate=i.date.asInt();var s="#"+$("#events").find(".event").first().attr("id")}else{n.endDate=e.objects.docInfo.forDate().asInt();var s="#noEvents"}$.get("/!get_all_events",n,function(e){if(e===1)alert("please try again later");else{var n=$(s).offset().top-$(document).scrollTop();t.addEvents(e.events,t),t.updatingTop(e.previous);var r=$(s).offset().top;$(document).scrollTop(r-n),setTimeout(function(){t.loadingMoreTop=!1},300),t.resetDateLine()}})}},compareEvents:function(e,t){return e.key&&t.key?e.key>t.key?1:-1:e.date>t.date?1:-1},removeAll:function(){this.events([])},removeFrom:function(e,t){e.removeFrom(t),this.cleanEvents()},cleanEvents:function(){var e=this,t=ko.utils.arrayFilter(e.events(),function(e){return e.eventType!=="empty"&&e.from().length});this.events(t)},removeEvents:function(e,t){var n=t.events();for(var r in n){var i=n[r];i.removeFrom(e)}},addEmpty:function(){var t,n=e.objects.docInfo.forDate();t=ko.utils.arrayFirst(this.events(),function(e){return e.date.equalDate(n)}),t||this.events.push({date:n,eventType:"empty"})},addEvents:function(t,n){ko.utils.arrayForEach(t,function(t){var r=ko.utils.arrayFirst(n.events(),function(e){return e.id===t.id});if(r){var i=ko.utils.arrayMap(t.from,function(t){new e.CalTag(t)});ko.utils.arrayForEach(i,function(e){r.cal_details.push(e)});var s=ko.utils.arrayFilter(t.from,function(e){return ko.utils.arrayFilter(r.from(),function(t){!t.sameCal(e)}).length});ko.utils.arrayForEach(s,function(e){r.push(e)})}else{var o=e.eventFactory(t);n.events.push(o);var u=ko.utils.arrayFirst(n.events(),function(e){return e.id===o.id})}}),this.addEmpty(this.events);var r=this.events();r.sort(n.compareEvents),this.events(r),n.resetDateLine()},dateChange:function(e){var t=e();if(t===0)return!0;var n=this.events();return n[t].date.sameDate(n[t-1].date)!==0},getPopulateArgs:function(){var t={};return t.startDate=e.objects.docInfo.forDate().asInt(),this.cal&&(t.cal=this.cal),this.tag&&(t.tag=this.tag),t},populate:function(){var e=this;e.loading(!0),console.log("this.tags = "+this.tag);var t=e.getPopulateArgs();console.log("args are "+JSON.stringify(t)),$.get("/!get_all_events",t,function(t){t===1?alert("please try again later"):(e.addEvents(t.events,e),e.loading(!1),e.updatingBottom(t.more),e.updatingTop(t.previous))})},refresh:function(){this.removeAll(),this.populate()},resetDateLine:function(){e.objects.dateLineSpy.refresh()}}),e.EventHolder=t}(modelPageView)}),!function(e){"use strict";function t(t){"shareButton"in t&&alert("something wrong has happened"),t.shareButton=ko.observable(!1),t.sharedx=ko.observable(t.shared),t.date=createDate(t.date),t.setShareButton=function(e){t.shareButton(e)},t.share=function(){$.post("/share_note/",{id:t.note_id},function(e){if(e===1){var n=t.sharedx()?!1:!0;t.sharedx(n)}})};if(t.event){t.event=e.eventFactory(t.event);if(t.type==="response"||t.type==="mention"||t.type==="comment")t.event.noteDisplay.notes=ko.utils.arrayMap(t.notes,function(n){var r=new e.Note(n);return r.highlighted=t.note_id===n.note_id,r}),t.event.noteDisplay.closeable=!1,t.event.noteDisplay.show(!0)}return"event_date"in t&&(t.eventDate=createDate(t.event_date)),"date"in t&&(t.date=createDate(t.date)),"details"in t&&("detailButton"in t&&alert("something wrong has happened"),t.detailButton=ko.observable(!1),t.acceptedx=ko.observable(t.accepted),t.setDetailButton=function(e){t.detailButton(e)},t.accept=function(){$.post("/share_detail/",{id:t.detail_id},function(e){if(e===1){var n=t.acceptedx()?!1:!0;t.acceptedx(n)}})}),t}function n(){this.genericInit(),this.updatingTop(!1),this.streamType("updates");var t=this;this.noEvents=ko.computed(function(){return!t.events().length&&!t.loading()&&!e.objects.eventCreator.show()?"no events have been added at this time for those people, select some more and we'll see how we do":""})}n.prototype=jQuery.extend(!0,{},e.GenericHolder.prototype),$.extend(n.prototype,{constructor:n,loadTop:function(){throw"update manager can't load top"},loadBottom:function(){if(!this.loadingMoreBottom){var e=this,n=e.events(),r={id:n[n.length-1].id};$.post("/!read_notification/",r,function(n){1===n?alert("something wrong happend, please refresh the page"):(ko.utils.arrayForEach(n.notifications,function(n){e.events.push(t(n))}),e.events.sort(function(e,t){return e.date.sameDate(t.date)*-1}),e.updatingBottom(n.more),e.loadingMoreBottom=!1)})}},populate:function(){var e=this;$.post("/!read_notification/",{},function(n){1===n?alert("something wrong happend, please refresh the page"):(e.events(ko.utils.arrayMap(n.notifications,function(e){return t(e)})),e.events.sort(function(e,t){return e.date.sameDate(t.date)*-1}),e.updatingBottom(n.more),e.loading(!1))})},dateChange:function(e){var t=e();if(t===0)return!0;var n=this.events();return n[t].date.sameDate(n[t-1].date)!==0},refresh:function(){this.updated(!1),this.notifications([]),this.populate()}}),e.updateHolder=n}(modelPageView),!function(e){"use strict";var t=function(){var t=this;if(!e.objects.docInfo.search)throw"unable to inialise search, not search term";this.searchTerm=e.objects.docInfo.search,this.genericInit(),this.noEvents=ko.computed(function(){return!t.events().length&&!t.loading()&&!e.objects.eventCreator.show()?"we couldn't find any events that matched that search term":""})};t.prototype=jQuery.extend(!0,{},e.GenericHolder.prototype),$.extend(t.prototype,{construct:t,loadBottom:function(){var t=this,n=t.events(),r=n[n.length-1],i={search_term:t.searchTerm,startId:r.id,direction:"bottom"},s=r.id;$.get("/!search_term/",i,function(n){1===n?alert("something wrong happened please refresh the page"):(ko.utils.arrayForEach(n.events,function(n){t.events.push(e.eventFactory(n))}),t.events.sort(function(e,t){return e.date.sameDate(t.date)}),t.updatingBottom(n.more),t.loadingMoreBottom=!1)})},loadTop:function(){var t=this;if(!t.loadingMoreTop){t.loadingMoreTop=!0;var n={};n.search_term=t.searchTerm;var r=t.events();n.direction="top";if(r.length){var i=r[0];n.endId=i.id;var s="#"+$("#events").find(".event").first().attr("id")}else{n.endDate=e.objects.docInfo.forDate().asInt();var s="#noEvents"}$.get("/!search_term/",n,function(n){if(n===1)alert("please try again later");else{var r=$(s).offset().top-$(document).scrollTop();ko.utils.arrayForEach(n.events,function(n){t.events.push(e.eventFactory(n))}),t.events.sort(function(e,t){return e.date.sameDate(t.date)}),t.updatingTop(n.previous);var i=$(s).offset().top;$(document).scrollTop(i-r),setTimeout(function(){t.loadingMoreTop=!1},500)}})}},populate:function(){var t=this,n={startDate:e.objects.docInfo.forDate().asInt()};n.search_term=t.searchTerm,$.get("/!search_term/",n,function(n){1===n?alert("something wrong happened please refresh the page"):(t.events(ko.utils.arrayMap(n.events,function(t){return e.eventFactory(t)})),t.events.sort(function(e,t){return e.date.sameDate(t.date)}),t.updatingBottom(n.more),t.updatingTop(n.previous),t.loading(!1))})}}),e.SearchHolder=t}(modelPageView),!function(e){"use strict";function n(){this.init()}var t=function(e){this.init(e),this.initMore(e)};t.prototype=e.CalTag.prototype,$.extend(t.prototype,{constructor:t,initMore:function(e){this.selected=ko.observable(e.selected),this.revealed=ko.observable(e.revealed)},revealable:function(){return this.type<2},select:function(){this.selected(!this.selected())},reveal:function(e){var t={calType:this.calType,cal:this.cal,tag:this.tag},n=this.revealed;$.post("/f/reveal_cal",t,function(t){t===0?(n(!n()),e&&e()):alert("something wrong happened, please refrest the page and try again")})},getTemplate:function(){return this.type===0?"calType":this.type===1?"cal":"tag"}}),n.prototype={constructor:n,init:function(){this.calTags=ko.observableArray(),this.calTypeOrder=["you","twitter people","popular people","popular tags"],this.loading=ko.observable(!1),this.populate()},sorter:function(e,t){return e.selected()&&!t.selected()?-1:e.selected()&&t.selected()?1:e.cal>t.cal?1:e.cal<t.cal?-1:0},populate:function(){var t=this,n=e.objects.docInfo.calType;$.get("/f/get_cal_tags",n,function(e){console.log("loading profile holder..."),e===1?alert("something wrong happened, please refresh the page and try again"):(e=ko.utils.arrayFilter(e,function(e){return e.tag||e.user}),t.processCalTags(e),t.loading(!0))})},processCalTags:function(e){var n=this,r=ko.utils.arrayMap(e,function(e){return new t(e)}),i=[];for(var s in n.calTypeOrder){var o=n.calTypeOrder[s],u=ko.utils.arrayFilter(r,function(e){return e.calType===o});u.sort(n.sorter),i=i.concat(u)}this.calTags(i)},getParentCalTag:function(e,t){if(e.type>t.type&&e.calType===t.calType){if(t.type!==1)return!0;if(t.type===1&&e.type===3)return t.cal===e.cal}return!1},getSubTypes:function(e,t){var n=this;return ko.utils.arrayFilter(n.calTags(),function(n){return e.isChild(n,t)})},getParentTypes:function(e){var t=this;return ko.utils.arrayFilter(t.calTags(),function(n){return t.getParentCalTag(e,n)&&n.selected()})},removeChildren:function(e){ko.utils.arrayForEach(self.calTags(),function(t){e.isChild(t)&&t.selected()&&removeCal(t)})},removeCal:function(e){$.post("/f/remove_calendar",e.toJSON(),function(t){t===1?alert("please refresh the page and try again"):e.select(!1)})},removeAll:function(e){var t=this;ko.utils.arrayForEach(t.calTags(),function(n){n.calType===e&&n.selected()&&t.removeCal(n)})},selectAll:function(e){var t=this;ko.utils.arrayForEach(t.calTags(),function(n){n.calType===e&&!n.selected()&&t.addCalendar(n)})},getChildOfType:function(e){var t=this;return ko.utils.arrayFilter(t.calTags(),function(t){return t.calType===e})},getChunksOfType:function(e){var t=this,n=ko.utils.arrayFilter(t.calTags(),function(t){return t.calType===e&&t.type!==0}),r=[],i,s,o,u=4;for(i=0,s=n.length;i<s;i+=u)r.push(n.slice(i,i+u));return r},clickCalendar:function(e){e.selected()?this.removeCal(e):this.addCalendar(e)},addCalendar:function(e){var t=this;$.post("/f/add_calendar",e.toJSON(),function(n){if(n===1)alert("please refresh the page and try again");else{var r=ko.utils.arrayFilter(t.getParentTypes(e),function(e){return e.selected()}),i=ko.utils.arrayFilter(t.getSubTypes(e),function(e){return e.selected()});if(r.length||i.length){var s=r.concat(i);console.log("for removal "+JSON.stringify(s)),ko.utils.arrayForEach(s,function(e){t.removeCal(e)})}e.selected(!0)}})}},e.ProfileHolder=n}(modelPageView),!function(){"use strict";modelPageView.objects.streamHolder=ko.observable(),modelPageView.objects.dateLineManager=ko.observable(),modelPageView.objects.profileHolder=ko.observable(),modelPageView.streamType=ko.observable(),modelPageView.objects.sideBar=ko.observable();var e=function(){modelPageView.objects.streamHolder(null),modelPageView.objects.dateLineManager(null),modelPageView.objects.profileHolder(null),modelPageView.streamType(null),modelPageView.objects.sideBar(null),modelPageView.objects.docInfo.cal=null,modelPageView.objects.docInfo.tag=null,modelPageView.objects.docInfo.forDate(new Date)};Sammy(function(){this.get("/!logout",function(){$(window).unload(),window.location.href="/!logout"}),this.get("/about",function(){$(window).unload(),window.location.href="/about"}),this.get("/#u",function(){e(),modelPageView.streamType("tracking"),modelPageView.objects.eventCreator.show()&&modelPageView.objects.eventCreator.closeBox(),modelPageView.objects.profileHolder(new modelPageView.ProfileHolder),modelPageView.objects.dateLineManager(new modelPageView.DateLineManager(modelPageView.objects.docInfo.forDate)),modelPageView.objects.userDetails.populate(modelPageView.objects.docInfo.user)}),this.get("/#p",function(){e(),modelPageView.streamType("updates"),modelPageView.objects.eventCreator.show()&&modelPageView.objects.eventCreator.closeBox(),modelPageView.objects.streamHolder(new modelPageView.updateHolder),modelPageView.objects.dateLineManager(new modelPageView.DateLineManager(modelPageView.objects.docInfo.forDate)),modelPageView.objects.userDetails.populate(modelPageView.objects.docInfo.user)}),this.get("/#s/",function(){e(),modelPageView.streamType("search"),modelPageView.objects.docInfo.search=this.params.search,modelPageView.objects.eventCreator.show()&&modelPageView.objects.eventCreator.closeBox(),modelPageView.objects.streamHolder(new modelPageView.SearchHolder),modelPageView.objects.dateLineManager(new modelPageView.DateLineManager(modelPageView.objects.docInfo.forDate)),modelPageView.objects.userDetails.populate(modelPageView.objects.docInfo.user),console.log("setting streamType to "+modelPageView.streamType())}),this.get("/#c/",function(){e(),modelPageView.objects.eventCreator.display(),modelPageView.objects.dateLineManager(new modelPageView.DateLineManager(modelPageView.objects.docInfo.forDate)),console.log("setting streamType to "+modelPageView.streamType())}),this.get("/d/:year/:month/:day",function(){e(),modelPageView.streamType("stream"),modelPageView.objects.eventCreator.show()&&modelPageView.objects.eventCreator.closeBox();var t=new Date(this.params.year,this.params.month-1,this.params.day);modelPageView.objects.docInfo.forDate(t),modelPageView.objects.streamHolder(new modelPageView.EventHolder),modelPageView.objects.dateLineManager(new modelPageView.DateLineManager(modelPageView.objects.docInfo.forDate)),modelPageView.objects.userDetails.populate(modelPageView.objects.docInfo.user),console.log("setting streamType to "+modelPageView.streamType())}),this.get("/t/:tag",function(){e();var t=this.params.tag;modelPageView.objects.sideBar(new modelPageView.TagDetail(t)),modelPageView.objects.dateLineManager(new modelPageView.DateLineManager(modelPageView.objects.docInfo.forDate)),modelPageView.objects.docInfo.tag=t,modelPageView.streamType("tag"),modelPageView.objects.streamHolder(new modelPageView.EventHolder({tag:t})),console.log("setting streamType to "+modelPageView.streamType())}),this.get("/:cal/d/:year/:month/:day",function(){var t=this.params.cal;e(),modelPageView.objects.sideBar(new modelPageView.CalDetail(t)),modelPageView.objects.eventCreator.show()&&modelPageView.objects.eventCreator.closeBox(),modelPageView.objects.docInfo.user===t?modelPageView.streamType("you"):modelPageView.streamType("cal"),modelPageView.objects.docInfo.forDate(new Date(this.params.year,this.params.month-1,this.params.day)),modelPageView.objects.streamHolder(new modelPageView.EventHolder({cal:t})),modelPageView.objects.dateLineManager(new modelPageView.DateLineManager(modelPageView.objects.docInfo.forDate)),modelPageView.objects.userDetails.populate(t),console.log("setting streamType to "+modelPageView.streamType())}),this.get("/:cal",function(){var e=this.params.cal;modelPageView.objects.sideBar(new modelPageView.CalDetail(e)),modelPageView.objects.profileHolder(null),modelPageView.objects.eventCreator.show()&&modelPageView.objects.eventCreator.closeBox(),modelPageView.objects.docInfo.user===e?modelPageView.streamType("you"):modelPageView.streamType("cal"),modelPageView.objects.docInfo.forDate(new Date),modelPageView.objects.docInfo.cal=this.params.cal;var e=this.params.cal;modelPageView.objects.docInfo.tag=undefined,modelPageView.objects.streamHolder(new modelPageView.EventHolder({cal:e})),modelPageView.objects.dateLineManager(new modelPageView.DateLineManager(modelPageView.objects.docInfo.forDate)),modelPageView.objects.userDetails.populate(e),console.log("setting streamType to "+modelPageView.streamType())}),this.get("/",function(){modelPageView.streamType("stream"),modelPageView.objects.profileHolder(null),modelPageView.objects.docInfo.tag=undefined,modelPageView.objects.docInfo.cal=undefined,modelPageView.objects.eventCreator.show()&&modelPageView.objects.eventCreator.closeBox(),modelPageView.objects.streamHolder(new modelPageView.EventHolder),modelPageView.objects.dateLineManager(new modelPageView.DateLineManager(modelPageView.objects.docInfo.forDate)),modelPageView.objects.userDetails.populate(modelPageView.objects.docInfo.user),console.log("setting streamType to "+modelPageView.streamType())})}).run(),ko.applyBindings(modelPageView)};
